{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/the-perils-of-web-dev/","result":{"data":{"site":{"siteMetadata":{"title":"Justinor.dev"}},"markdownRemark":{"id":"f5b1e164-5532-5650-8f4d-a0f5e9127bab","excerpt":"When I first came up with the idea to highlight the current page with a rounded box, it sounded really easy to implement. I even decided to go really simple and…","html":"<p>When I first came up with the idea to highlight the current page with a rounded box, it sounded really easy to implement. I even decided to go really simple and make it just invert the background. So in <code class=\"language-text\">light</code> mode, it would be a black box which had white text insde, and the opposite for dark mode. What could go wrong?</p>\n<blockquote>\n<p>everything.</p>\n</blockquote>\n<p>Lets go through some of the blood sweat and tears I went through so you don’t have to go through the same!</p>\n<h1 id=\"inverting-colors\" style=\"position:relative;\"><a href=\"#inverting-colors\" aria-label=\"inverting colors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inverting Colors</h1>\n<p>Essentially, I saw this css-tricks article about <a href=\"https://css-tricks.com/methods-contrasting-text-backgrounds/\">contrasting text backgrounds</a> which involved using the <code class=\"language-text\">mix-blend-mode: difference;</code> CSS on the foreground so that it would invert its background. This would work flawlessly for the dark background with white foreground, and its also the example they gave in this article:</p>\n<deckgo-highlight-code language=\"css\"  >\n          <code slot=\"code\">header {\n  background: url(black-and-white-image.jpg);\n}\n\nh2 {\n  color: white;\n  mix-blend-mode: difference;\n}</code>\n        </deckgo-highlight-code>\n<p>However, try to do it for the opposite case and things come crashing down.</p>\n<h2 id=\"try-1-backdrop-filter\" style=\"position:relative;\"><a href=\"#try-1-backdrop-filter\" aria-label=\"try 1 backdrop filter permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Try 1: backdrop-filter</h2>\n<p>I initially tried using this CSS, which applies a filter to the background of this image - this is actually how I have blurred everything when a user clicks the sandwich menu in mobile view. When combined with <code class=\"language-text\">contrast(2)</code> I was able to get commendable results on chrome. However, as soon as I tried using the website with firefox, the backdrop filter was no where to be found! This is because Mozilla Firefox have <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/backdrop-filter\">hidden the feature behind an experimental flag</a>…</p>\n<h2 id=\"try-2-back-to-mix-blend-mode\" style=\"position:relative;\"><a href=\"#try-2-back-to-mix-blend-mode\" aria-label=\"try 2 back to mix blend mode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Try 2: back to mix-blend-mode</h2>\n<p>So I went back to the original method, and decided on figuring out how to have this inverted color idea work for both light and dark modes. Essentially, I’ve found that I need to do the following things:</p>\n<ul>\n<li>color the text normally</li>\n<li>color the inverting div <strong>white</strong>, with <code class=\"language-text\">mix-blend-mode: difference</code></li>\n<li>\n<p><strong>wrap everything in a div which provides the colors:</strong></p>\n<ul>\n<li><code class=\"language-text\">background: var(--color-background)</code></li>\n<li><code class=\"language-text\">color: var(--color-text)</code></li>\n<li>transitions to make toggling the color easier on the eye</li>\n</ul>\n</li>\n</ul>\n<p>These things in <strong>bold</strong> took me very long to figure out~</p>\n<p>Especially the <strong>div that provides colors</strong>, you can’t apply the color to the body, it needs to be in a div you style, or else in Chrome it results in the <code class=\"language-text\">mix-blend-mode</code> failing, BUT IT WORKS FINE IN FIREFOX!!</p>\n<p>So many times, it would either only work in chrome, only work in firefox, only dark mode works, only light mode works. Shout out to my <a href=\"https://atharvdamle.com/\">friend</a> who provided me support in my darkest moments, he was the one to suggesting making the inverting div <strong>white</strong>, very smart guy.</p>\n<p>In code, here is a watered down example consisting only the color variables required to pull off this effect:</p>\n<deckgo-highlight-code language=\"jsx\"  >\n          <code slot=\"code\">// styles\nconst ColorProvider = styled.div`\n  background: var(--color-background);\n  color: var(--color-text);\n  transition: all 0.25s linear;\n`;\n\nconst Underline = styled(motion.div)`\n  mix-blend-mode: difference;\n  background-color: white;\n`;\n\nconst StyledLink = styled(Link)`\n  color: var(--color-text);\n`;\n\n// code\n&lt;PageWrapper&gt;\n  ...\n  &lt;StyledLi&gt;\n    &lt;Underline /&gt;\n    &lt;StyledLink&gt;{name}&lt;/StyledLink&gt;\n  &lt;/StyledLi&gt;\n  ...\n&lt;/PageWrapper&gt;;</code>\n        </deckgo-highlight-code>\n<h1 id=\"fouc\" style=\"position:relative;\"><a href=\"#fouc\" aria-label=\"fouc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>FOUC</h1>\n<p>Flash of Unstyled Content is a prominent problem in Gatsby, as part of the reason why it can serve content so fast is because it prebuilds all the html. Because it can serve the html so fast, more often than not, the html loads first before CSS styles are loaded in, resulting in blank white unstyled content flickering before the styles load in. I did not like this.</p>\n<h2 id=\"try-1---maybe-material-ui\" style=\"position:relative;\"><a href=\"#try-1---maybe-material-ui\" aria-label=\"try 1   maybe material ui permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Try 1 - Maybe Material-ui?</h2>\n<p>I was using <code class=\"language-text\">material-ui</code> as its my goto web-ui toolkit. However, I nearly considered giving up this toolkit while making this website. It appeared that whenever I used their <code class=\"language-text\">themeProvider</code>, it would completely break my styles, display a FOUC, and transitions applied to the body did not apply to any <code class=\"language-text\">material-ui</code> components.</p>\n<p>However, I soon learnt that I was mistaken, as I had followed the documentation for <code class=\"language-text\">material-ui</code> blindly, and used the <code class=\"language-text\">&lt;CssBaseline /&gt;</code> component because they used it. Short answer - this will screw up the original css in the page. This was particularly bad for my case, as I needed to define the themes with css variables or else a FOUC would occur on every page load as Gatsby would not know about the style.</p>\n<p>However, even without <code class=\"language-text\">&lt;CssBaseline /&gt;</code>, things were still going sour, FOUC was showing, I was still awake at 2am trying to fix this.</p>\n<h2 id=\"try-2---styledcomponents\" style=\"position:relative;\"><a href=\"#try-2---styledcomponents\" aria-label=\"try 2   styledcomponents permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Try 2 - styled(components)</h2>\n<p>TURNS OUT: I’ve been applying global styles through a component <code class=\"language-text\">createGlobalStyle</code> from <code class=\"language-text\">&#39;styled-components&#39;</code>. This applied a style to the body which set the <code class=\"language-text\">background-color</code> and <code class=\"language-text\">color</code>. It doesn’t seem to work immediately on page load, resulting in a flash of white in dark mode, before a transition to the proper color. So now, I create my own div styled with in-line CSS defining those color css variables. The result works like a charm!</p>\n<deckgo-highlight-code language=\"jsx\"  >\n          <code slot=\"code\">const ColorProvider = styled.div`\n  background: var(--color-background);\n  color: var(--color-text);\n  transition: all 0.25s linear;\n`;\n\nconst Layout: React.FC = ({ children }) =&gt; {\n  return (\n    &lt;&gt;\n      &lt;ColorProvider&gt;\n        &lt;Header /&gt;\n        {children}\n        &lt;Footer /&gt;\n      &lt;/ColorProvider&gt;\n    &lt;/&gt;\n  );\n};</code>\n        </deckgo-highlight-code>\n<p>This is only the stuff I remembered that I fixed, there was so much trial and error, and me reloading the site 100 times, that I’ve probably forgotten half of the stuff I tried to do to fix these problems I had.</p>","frontmatter":{"title":"The Quest for a cool header design","date":"September 05, 2020","description":"Something seemingly simple to implement becomes the most annoying thing to implement ever.","tags":["frontend","gatsby"]},"headings":[{"depth":1,"id":"inverting-colors","value":"Inverting Colors"},{"depth":2,"id":"try-1-backdrop-filter","value":"Try 1: backdrop-filter"},{"depth":2,"id":"try-2-back-to-mix-blend-mode","value":"Try 2: back to mix-blend-mode"},{"depth":1,"id":"fouc","value":"FOUC"},{"depth":2,"id":"try-1---maybe-material-ui","value":"Try 1 - Maybe Material-ui?"},{"depth":2,"id":"try-2---styledcomponents","value":"Try 2 - styled(components)"}]}},"pageContext":{"slug":"/blog/the-perils-of-web-dev/","previous":{"fields":{"slug":"/blog/gatsby-is-cool/"},"frontmatter":{"title":"Gatsby has a lot of cool plugins","tags":["gatsby","frontend","javascript"]}},"next":null}}}